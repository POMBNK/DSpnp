-------------------------------------------------------------------------------------------------
1. Скачиваем и устанавливаем программу OpenPNP
2. Запускаем программу и во вкладке View->language выбираем Русский язык. 
3. В окне настройки "Machine Setup" удаляем драйвер, камеры, актуаторы и насадки.
4. Перезагружаем программу.

-------------------------------------------------------------------------------------------------
Настройка драйвера:
5. В окне настройки "Machine Setup" выбираем ветку Drivers и нажимаем значёк + (добавить драйвер). Из предложенного списка выбираем "GcodeDriver" и нажимаем ОК
6. Открываем добавленный драйвер и во вкладке "Configuration" выбираем COM-порт (можно посмотреть в Диспетчере устройств ОС) и скорость общения с платой, которая была задана в прошивке. Нажимаем "Apply"
   Открываем вкладку "Driver Settings" и устанавливаем:
	Command Timeout (ms) - 10000 (время ожидания подтверждения выполнения команды)
	Connect Wait Time (ms) - 3000 (время ожидания подключения к станку)
	Max Feed Rate - 16000 (максимальная скорость движения по осям. в моём случае получилось 16000)
   Нажимем Apply 

   !!! "Apply" ЖМЁМ ВЕЗДЕ ГДЕ ЧТО-ЛИБО ИСПРАВЛЯЕМ ИЛИ НАСТРАИВАЕМ !!!

   Во вкладке Gcode в первом выпадающем списке выбираем Default и в выпадающем списке Setting выбираем и настравиваем:
	COMMAND_CONFIRM_REGEX
		^ok.*
	COMMAND_ERRORE_REGEX
		^error.*
	ENABLE_COMMAND
		G21 ; Set millimeters mode
		G90 ; Set absolute positioning mode
		M82 ; extruder in absolute mode
		G92 X0 Y0 Z0 E0; openpnp is at 0, grbl must not neccessarily
		M42 P9 S255 ; turn on topcamera leds
	DISABLE_COMMAND
		M42 P9 S0 ; turn off topcamera leds
		M42 P10 S0 ; turn off bottomcamera leds
		M42 P8 S0 ; turn off vacuum
		M42 P5 S0 ; turn off pump
		M84; steppers off
	HOME_COMMAND
		G28
		G0 X0 Y0 Z0
	MOVE_TO_COMMAND
		G0 {X:X%.4f} {Y:Y%.4f} {Z:Z%.4f} {Rotation:E%.4f} F{FeedRate:%.0f} ; Send standard Gcode move
	MOVE_TO_COMPLETE_COMMAND
		M400 ; Wait for moves to complete before returning

7. В ветке Axes настраиваем к какому драйверу подключена каждая из осей станка, а так же можем установить компенсацию люфтов:
    Выбираем Axes->ReferenceControllerAxis x:
	в выпадающем списке Driver выбираем GCodeDriver
	в окне AxisLetter даём букву оси - X.
	в выпадающем списке Backlash Compensation выбираем OneSidedPositioning. В окне Backlash Offset устанавливаем количество милиметров движения каретки по оси для компенсации люфта.
  Аналогичную операцию проделываем для всех осей:
    Выбираем Axes->ReferenceControllerAxis y:
	в выпадающем списке Driver выбираем GCodeDriver
	в окне AxisLetter даём букву оси - Y.
	в выпадающем списке Backlash Compensation выбираем OneSidedPositioning. В окне Backlash Offset устанавливаем компенсации люфта.
    Выбираем Axes->ReferenceControllerAxis zN1:
	в выпадающем списке Driver выбираем GCodeDriver
	в окне AxisLetter даём букву оси - Z.
    Выбираем Axes->ReferenceControllerAxis rotationN1:
	в выпадающем списке Driver выбираем GCodeDriver
	в окне AxisLetter даём имя оси - Rotation.

8. В левой нижней части приложения нажимаем кнопку включения и отравляем все оси в домашнюю точку. Станок должен уехать в домашнюю точку и после этого должна появиться возможность управления осями с помощью кнопок управления.

-------------------------------------------------------------------------------------------------
Настройка каретки (В окне настройки "Machine Setup" ветка "Heads"):
9. Настройка верхней камеры:
	В ветке Heads->ReferenceHead H1->Cameras добавляем OpenPnpCaptureCamera и во вкладке General Configuration переименовываем её в Top (верхняя камера)
	Во вкладке DeviceSettings выбираем камеру, которая установлена на каретке.
	Во вкладке Vision выбираем фиксированное время после движения каретки и устанавливаем его
	Во вкладке Lens Calibration калбируем камеру с помощью рисунка. Если изображение не распознаётся то можно поиграть яркостью и контрастройстью во вкладке DeviceSettings.
	Во вкладке General Configuration с помощью рисунка настраиваем количество пикселей на 1мм
	Во вкладке Image Transforms настраиваем картинку так чтобы она показывала изображение как будто мы смотрим на станок сверху - ось X расположена горизонтально вправо идёт на увеличение, а ось Y вертикально и вверх на увеличение.
	Пробуем поуправлять станком: в окне изображения с камеры нажимаем и удерживая левую кнопку мыши отводим курсор в место куда надо перевести цент изображения камеры и отпускаем кнопку. Станок не двигается. А так же нет управления с кнопок панели управления. Идём во вкладку Position и устанавливаем оси которыми можно управлять когда выбрана верхняя камера. Для оси Z устанавливаем zTop (я не разобрался почему именно так, но при настройке питателей так станок работает правильно). Осью Z невозможно управлять когда выбрана верхняя камера в выпадающем списке с устройствами в Панели управления.
10. Подсветка:
	В ветке Heads->ReferenceHead H1->Actuators выбираем Reference Actuator и переименовываем его в TopCamLights, а так же в Coordinate System указываем какими осями можно управлять если будет выбран этот актуатор.
	В ветке Drivers->GcodeDriver открываем вкладку Gcode и выбираем в первом выпадающем списке Actuator: H1 TopCamLights. В выпадающем списке Setting выбираем ACTUATE_BOOLEAN_COMMAND и в окне ниже прописываем: M42 P9 {True:S255}{False:S0} (в дальнейшем при настройке компьютерного зрения максимальное значение яркости S255 может быть нужно будет изменить. Возможно подсветка будет сильно яркой)
	В ветке Heads->ReferenceHead H1->Cameras->OpenPnpCaptureCamera Top во вкладке General Configuration в выпадающем списке Light Actuator устанавливаем актуатор подсветки TopCamLights.
11. Клапан открывающий вакуум компрессора:
	В ветке Heads->ReferenceHead H1->Actuators выбираем Reference Actuator и присваиваем ему имя A1 и чуть ниже в Coordinate System так же указываем какими осями можно управлять 
	В ветке Driver->GcodeDriver открываем вкладку Gcode и выбираем в первом выпадающем списке Actuator: H1 A1. В выпадающем списке Setting выбираем ACTUATE_BOOLEAN_COMMAND и в окне ниже прописываем: M42 P8 {True:S255}{False:S0}
12. Помпа:
	В ветке Heads->ReferenceHead H1->Actuators выбираем Reference Actuator и присваиваем ему имя Pump и чуть ниже в Coordinate System так же указываем какими осями можно управлять
	В ветке Driver->GcodeDriver открываем вкладку Gcode и выбираем в первом выпадающем списке Actuator: H1 Pump. В выпадающем списке Setting выбираем ACTUATE_BOOLEAN_COMMAND и в окне ниже прописываем: M42 P5 {True:S255}{False:S0}
	В ветке Heads->ReferenceHead H1 указываем какой актуатор является помпой. В выпадающем списке Vacuum Pump Actuator выбираем Pump.
13. Сопло:
	В ветке Heads->ReferenceHead H1->Nozzles добавляем ReferanceNozzle и переименовываем в N1 а чуть ниже в Coordinate System так же указываем какими осями можно управлять
	Чуть ниже в Settings можно установить время удержания сопла при захвате компонента из питателя (Pick Dwell Time) и при установке компонента на плату (Place Dwell Time). При первых тестах установки компонентов это время можно увеличить до 2-5 секунд для настройки и наблюдения за работой установщика.
	Во вкладке Offset Wizard можно произвести калибровку смещения сопла относительно камеры, для этого надо подвести сопло к какой-либо точке и нажать на кнопку "Store nozzle mark position" (в оригинальной инструкции предлагается насыпать немного муки на рабочее поле и упереться соплом в муку), далее подвести к этой же точке камеру и нажать "Calculate nozzle offset". Нажать Apply
	В правой части панели управления есть кнопки "отправить сопло в точку куда смотрит камера" и "отправить камеру в точку где сейчас стоит сопло". Проверить насколько точно совпадают сопло с камерой. При необходимости корректируем смещение вручную и ещё раз проверяем пока не добьёмся достаточной точности.
	Во вкладке Vacuum в выпадающем списке Vacuum Actuator выбираем A1.

	Все устройства можно проверить в Панели управления во вкладке Актуаторы.
-------------------------------------------------------------------------------------------------
Насадки:
17. В ветке Nozzle Tips добавляем новую насадку и переименовываем её. Я даю названия номерами как написано на насадках (502, 503 и т.д.).
	Переходим во вкладку Tool Changer и начиная сверху вниз указываем координаты траектории смены сопла:
	Подводим сопло к месту над насадкой установленной в своём держателе и фиксируем координаты нажатием на "синий значёк сопла" напротив первой строки. Так же можно установить скорость между движениями по заданным координатам.
	Далее заводим сопло в насадку и так же фиксируем координаты.
	Вынимаем насадку из держателя и фиксируем координаты. 
	Поднимаем сопло с насадкой и фиксируем координаты. 
   Аналогичным образом добавляем другие насадки.

18. Далее в ветке Heads->ReferenceHead H1->Nozzles->ReferenceNozzle N1 во вкладке Tool Changer установливаем галочку напротив Automatic Tool Changer Enabled и во вкладке Nozzle Tips указываем совместимые насадки, а так же какая насадка сейчас установлена.

    Теперь перейдя в ветку Nozzle Tips можно выбрать необходимую насадку и установить на сопло нажав на соответствующий значёк.

-------------------------------------------------------------------------------------------------
19. Подсветка нижней камеры:
	В ветке Actuators добавляем ReferenceActuator и переименовываем его в BottomCamLights
	В ветке Driver->GcodeDriver открываем вкладку Gcode и выбираем в первом выпадающем списке Actuator: [No Head] BottomCamLights. В выпадающем списке Setting выбираем ACTUATE_BOOLEAN_COMMAND и в окне ниже прописываем: M42 P10 {True:S255}{False:S0}
20. Настройка нижней камеры аналогична настройке верхней (В окне настройки "Machine Setup" ветка "Cameras"):
	В ветке Cameras добавляем OpenPnpCaptureCamera и во вкладке General Configuration переименовываем её в Bottom (нижняя камера) и выбираем в выпадающем списке ниже что эта камера смотрит вверх Looking Up.
	В выпадающем списке Light Actuator устанавливаем актуатор подсветки BottomCamLights и устанавливаем галочку OFF After Capture? (выключение подсветки после снимка для компьютерного зрения)
	Во вкладке DeviceSettings выбираем камеру, которая установлена на столе.
	Во вкладке Vision выбираем настройки времени стабилизации камеры после движения
	Над изображением камеры с каретки в выпадающем списке выбираем Camera:Bottom
	Во вкладке Lens Calibration калбируем камеру с помощью рисунка
	Подводим сопло к нижней камере и во вкладке Image Transforms настраиваем изображение. Оно должно выглядеть так, как если бы мы смотрели на зеркало, лежащее на полу, отражающее вид от камеры к соплу.
	Совмещаем центр сопла с камерой и во вкладке Position устанавливаем координаты камеры и на каком расстоянии по оси Z настроен фокус камеры. Подводим сопло к центру камеры и установив нужную высоту нажимаем синий значёк с соплом.
	Меняем сопло на самое большое, открываем клапан и включаем помпу. Возвращаем сопло под камеру нажав на красный значёк сопла во вкладке Position в меню настройки камеры. Прикрепляем к соплу картинку и во вкладке General Configuration с помощью рисунка настраиваем количество пикселей на 1мм

-------------------------------------------------------------------------------------------------
Сброс компонентов:
21. В ветке устройств выбираем самый верхний компонент ReferenceMachine и во вкладке Configuration устанавливаем место сброса компонентов Discard Location. В это место будет производится сброс компонентов во время настройки питателей. Подводим сопло к контейнеру для сброса и нажимаем на синий значёк сопла.
